import{b as ze,a6 as Re,d as K,a as R,be as Pe,i as A,c as M,bf as ae,a1 as Z,m as Be,o as b,s as U,v,a4 as le,N as a,n as E,f as s,h as V,D as re,O as qe,g as z,ag as k,r as te,e as I,Q as ve,a5 as ce,P as Fe,x as d,U as Ve,_ as Oe,a$ as Ye,a7 as We,E as ee,b4 as Xe,bg as ne,bh as ue,a3 as Qe,bi as de,bj as Ze,aJ as ye,bk as be,aD as ke,aE as we,bb as pe,bl as Ge,aH as Je,af as Q,bm as he,aV as C,aZ as L,bn as ge,bo as Ke,C as et,bp as fe}from"./index-74428da3.js";import{E as tt}from"./el-card-8e86506b.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                   *//* empty css                   */import{E as nt,a as ot}from"./el-descriptions-item-0bfe182f.js";import{h as st,e as it,b as me}from"./index-40379247.js";import{E as at}from"./index-5ded35b3.js";import{h as Ce}from"./index-3741449e.js";import{_ as lt}from"./index-74314f91.js";import{d as _e}from"./index-44f2063f.js";import{t as rt}from"./BaseUtils-fa04cc4b.js";import{c as De}from"./index-ec2f945e.js";import"./isUndefined-aa0326a0.js";import"./el-progress-cadc640c.js";const $e=["success","info","warning","error"],ct=ze({customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},icon:{type:Re},id:{type:String,default:""},message:{type:K([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:K(Function),default:()=>{}},onClose:{type:K(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...$e,""],default:""},zIndex:Number}),ut={destroy:()=>!0},dt=["id"],pt=["textContent"],ht={key:0},gt=["innerHTML"],ft=R({name:"ElNotification"}),mt=R({...ft,props:ct,emits:ut,setup(e,{expose:n}){const t=e,{ns:o,zIndex:h}=Pe("notification"),{nextZIndex:i,currentZIndex:l}=h,{Close:c}=Ye,p=A(!1);let m;const w=M(()=>{const g=t.type;return g&&ae[t.type]?o.m(g):""}),D=M(()=>t.type&&ae[t.type]||t.icon),F=M(()=>t.position.endsWith("right")?"right":"left"),J=M(()=>t.position.startsWith("top")?"top":"bottom"),_=M(()=>{var g;return{[J.value]:`${t.offset}px`,zIndex:(g=t.zIndex)!=null?g:l.value}});function H(){t.duration>0&&({stop:m}=We(()=>{p.value&&P()},t.duration))}function Y(){m==null||m()}function P(){p.value=!1}function W({code:g}){g===ee.delete||g===ee.backspace?Y():g===ee.esc?p.value&&P():H()}return Z(()=>{H(),i(),p.value=!0}),Be(document,"keydown",W),n({visible:p,close:P}),(g,B)=>(b(),U(Ve,{name:s(o).b("fade"),onBeforeLeave:g.onClose,onAfterLeave:B[1]||(B[1]=X=>g.$emit("destroy")),persisted:""},{default:v(()=>[le(a("div",{id:g.id,class:E([s(o).b(),g.customClass,s(F)]),style:V(s(_)),role:"alert",onMouseenter:Y,onMouseleave:H,onClick:B[0]||(B[0]=(...X)=>g.onClick&&g.onClick(...X))},[s(D)?(b(),U(s(re),{key:0,class:E([s(o).e("icon"),s(w)])},{default:v(()=>[(b(),U(qe(s(D))))]),_:1},8,["class"])):z("v-if",!0),a("div",{class:E(s(o).e("group"))},[a("h2",{class:E(s(o).e("title")),textContent:k(g.title)},null,10,pt),le(a("div",{class:E(s(o).e("content")),style:V(g.title?void 0:{margin:0})},[te(g.$slots,"default",{},()=>[g.dangerouslyUseHTMLString?(b(),I(ve,{key:1},[z(" Caution here, message could've been compromised, never use user's input as message "),a("p",{innerHTML:g.message},null,8,gt)],2112)):(b(),I("p",ht,k(g.message),1))])],6),[[ce,g.message]]),g.showClose?(b(),U(s(re),{key:0,class:E(s(o).e("closeBtn")),onClick:Fe(P,["stop"])},{default:v(()=>[d(s(c))]),_:1},8,["class","onClick"])):z("v-if",!0)],2)],46,dt),[[ce,p.value]])]),_:3},8,["name","onBeforeLeave"]))}});var _t=Oe(mt,[["__file","notification.vue"]]);const G={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},oe=16;let vt=1;const q=function(e={},n=null){if(!Xe)return{close:()=>{}};(typeof e=="string"||ne(e))&&(e={message:e});const t=e.position||"top-right";let o=e.offset||0;G[t].forEach(({vm:w})=>{var D;o+=(((D=w.el)==null?void 0:D.offsetHeight)||0)+oe}),o+=oe;const h=`notification_${vt++}`,i=e.onClose,l={...e,offset:o,id:h,onClose:()=>{yt(h,t,i)}};let c=document.body;ue(e.appendTo)?c=e.appendTo:Qe(e.appendTo)&&(c=document.querySelector(e.appendTo)),ue(c)||(c=document.body);const p=document.createElement("div"),m=d(_t,l,ne(l.message)?{default:()=>l.message}:null);return m.appContext=n??q._context,m.props.onDestroy=()=>{de(null,p)},de(m,p),G[t].push({vm:m}),c.appendChild(p.firstElementChild),{close:()=>{m.component.exposed.visible.value=!1}}};$e.forEach(e=>{q[e]=(n={})=>((typeof n=="string"||ne(n))&&(n={message:n}),q({...n,type:e}))});function yt(e,n,t){const o=G[n],h=o.findIndex(({vm:m})=>{var w;return((w=m.component)==null?void 0:w.props.id)===e});if(h===-1)return;const{vm:i}=o[h];if(!i)return;t==null||t(i);const l=i.el.offsetHeight,c=n.split("-")[0];o.splice(h,1);const p=o.length;if(!(p<1))for(let m=h;m<p;m++){const{el:w,component:D}=o[m].vm,F=Number.parseInt(w.style[c],10)-l-oe;D.props.offset=F}}function bt(){for(const e of Object.values(G))e.forEach(({vm:n})=>{n.component.exposed.visible.value=!1})}q.closeAll=bt;q._context=null;const kt=Ze(q,"$notify");var x=(e=>(e[e.home=3]="home",e[e.back=4]="back",e[e.dpadUp=19]="dpadUp",e[e.dpadDown=20]="dpadDown",e[e.dpadLeft=21]="dpadLeft",e[e.dpadRight=22]="dpadRight",e[e.dpadCenter=23]="dpadCenter",e[e.volumeUp=24]="volumeUp",e[e.volumeDown=25]="volumeDown",e[e.volumeMute=164]="volumeMute",e[e.menu=82]="menu",e[e.task=187]="task",e[e.power=26]="power",e[e.space=62]="space",e[e.backSpace=67]="backSpace",e[e.enter=66]="enter",e))(x||{});const N=e=>(ke("data-v-ff16ec7c"),e=e(),we(),e),wt={class:"tv_control"},Ct={class:"tv_control_keyboard"},Dt={class:"tv_keyboard"},$t=N(()=>a("span",{class:"iconfont icon-shang"},null,-1)),St=[$t],xt=N(()=>a("span",{class:"iconfont icon-shang"},null,-1)),Et=[xt],It=N(()=>a("span",{class:"iconfont icon-shang"},null,-1)),Lt=[It],Mt=N(()=>a("span",{class:"iconfont icon-shang"},null,-1)),Nt=[Mt],Tt=N(()=>a("span",{class:"iconfont icon-ok"},null,-1)),At=[Tt],Ht=N(()=>a("span",{class:"iconfont icon-home1"},null,-1)),Ut=[Ht],jt=N(()=>a("span",{class:"iconfont icon-chexiao"},null,-1)),zt=[jt],Rt=N(()=>a("span",{class:"iconfont icon-liebiao"},null,-1)),Pt=[Rt],Bt={class:"tv_control_tips"},qt=N(()=>a("p",null,"OK:Enter",-1)),Ft=R({__name:"index",setup(e){const{device:n}=ye();function t(l){switch(l){case"ArrowUp":n==null||n.pressKeyCode(x.dpadUp);break;case"ArrowRight":n==null||n.pressKeyCode(x.dpadRight);break;case"ArrowDown":n==null||n.pressKeyCode(x.dpadDown);break;case"ArrowLeft":n==null||n.pressKeyCode(x.dpadLeft);break;case"Enter":n==null||n.pressKeyCode(x.dpadCenter);break;case"Home":n==null||n.pressKeyCode(x.home);break;case"Escape":n==null||n.pressKeyCode(x.back);break;case"ControlRight":n==null||n.pressKeyCode(x.menu);break}}function o(l){switch(console.log(l),l.code){case"ArrowUp":case"ArrowRight":case"ArrowDown":case"ArrowLeft":case"Enter":case"Home":case"Escape":case"ControlRight":t(l.code),l.preventDefault();break}}function h(){window.addEventListener("keydown",o,!0),console.log("开始按键事件监听")}function i(){window.removeEventListener("keydown",o,!0),console.log("移除按键事件监听")}return Z(()=>{h()}),be(()=>{i()}),(l,c)=>(b(),I("div",wt,[a("div",Ct,[a("div",Dt,[a("div",{class:"tv_keyboard_item tv_keyboard_up",onClick:c[0]||(c[0]=p=>t("ArrowUp"))},St),a("div",{class:"tv_keyboard_item tv_keyboard_right",onClick:c[1]||(c[1]=p=>t("ArrowRight"))},Et),a("div",{class:"tv_keyboard_item tv_keyboard_left",onClick:c[2]||(c[2]=p=>t("ArrowLeft"))},Lt),a("div",{class:"tv_keyboard_item tv_keyboard_down",onClick:c[3]||(c[3]=p=>t("ArrowDown"))},Nt),a("div",{class:"tv_keyboard_item tv_keyboard_ok",onClick:c[4]||(c[4]=p=>t("Enter"))},At)]),a("div",{class:"tv_keyboard_floatitem tv_keyboard_home",onClick:c[5]||(c[5]=p=>t("Home"))},Ut),a("div",{class:"tv_keyboard_floatitem tv_keyboard_back",onClick:c[6]||(c[6]=p=>t("Escape"))},zt),a("div",{class:"tv_keyboard_floatitem tv_keyboard_menu",onClick:c[7]||(c[7]=p=>t("ControlRight"))},Pt)]),a("div",Bt,[a("h5",null,k(l.$t("jian-pan-kuai-jie-jian")),1),a("p",null,k(l.$t("shang-fang-xiang-jian-shang")),1),a("p",null,k(l.$t("xia-fang-xiang-jian-shang")),1),a("p",null,k(l.$t("zuo-fang-xiang-jian-shang")),1),a("p",null,k(l.$t("you-fang-xiang-jian-shang")),1),qt,a("p",null,k(l.$t("fan-hui"))+":ESC",1),a("p",null,k(l.$t("zhu-ye"))+":HOME",1),a("p",null,k(l.$t("cai-dan"))+":RightCtrl",1)])]))}});const Vt=O(Ft,[["__scopeId","data-v-ff16ec7c"]]);var se=(e=>(e.Lan="#319DF4",e.Lv="#92C656",e.Cheng="#FFB14F",e.Hong="#F55044",e.Hui="#6D8794",e.Zi="#865BFF",e.QianLan="#13C1D7",e))(se||{}),j=(e=>(e.Default="",e.GRID="grid",e.FLEX="flex",e))(j||{});const Ot={class:"control_layout"},Yt={class:"control_layout_header"},Wt={class:"control_layout_header__title"},Xt={class:"control_layout_header__solt"},Qt=R({__name:"index",props:{title:{type:String,default:""},tipColor:{type:String,default:"#ff9800"},layout:{type:String,default:j.GRID}},setup(e){A(se);const n=e,t=M(()=>{switch(n.layout){case j.GRID:return"grid";case j.FLEX:return"flex";case j.Default:default:return""}});return(o,h)=>(b(),I("div",Ot,[a("div",Yt,[a("span",{class:"control_layout_header__tips",style:V({backgroundColor:n.tipColor})}," ",4),a("span",Wt,k(n.title),1),a("span",Xt,[te(o.$slots,"head",{},void 0,!0)])]),a("div",{class:E(["control_layout_body",s(t)])},[te(o.$slots,"body",{},void 0,!0)],2)]))}});const Zt=O(Qt,[["__scopeId","data-v-662762d9"]]),Gt=e=>(ke("data-v-d951e9d3"),e=e(),we(),e),Jt={class:"control_item_title overflow1"},Kt=Gt(()=>a("span",{class:"control_item_tipsbtn iconfont icon-gantanhao"},null,-1)),en=R({__name:"index",props:{icon:{type:String,default:"icon-ok",reqired:!0},bgColor:{type:String,default:"#4d5eba",reqired:!0},title:{type:String,default:"--",reqired:!0},disabled:{type:Boolean,default:!1},tips:{type:String,default:""}},emits:["click"],setup(e,{emit:n}){const t=n,o=e;function h(){o.disabled||t("click")}const i=M(()=>{const{icon:c}=pe(o);return c.value}),l=M(()=>{const{bgColor:c}=pe(o);return{backgroundImage:`linear-gradient(135deg, ${st(c.value,.5)} 20%, ${c.value} 100%)`}});return(c,p)=>{const m=Ge,w=at,D=Ce;return b(),I("div",{class:E(["control_item",{disabled:o.disabled}]),onClickCapture:h},[o.disabled?(b(),U(m,{key:1,value:"vip",class:"item"},{default:v(()=>[a("div",{class:"control_item_iconwrapper",style:V(l.value)},[a("span",{class:E(["control_item_icon iconfont",i.value])},null,2)],4)]),_:1})):(b(),I("div",{key:0,class:"control_item_iconwrapper",style:V(l.value)},[a("span",{class:E(["control_item_icon iconfont",i.value])},null,2)],4)),d(w,{disabled:o.title.length<15,content:o.title,placement:"bottom",effect:"light"},{default:v(()=>[a("div",Jt,k(o.title),1)]),_:1},8,["disabled","content"]),o.tips&&!o.disabled?(b(),U(D,{key:2,placement:"right",title:"提示",width:200,trigger:"hover",content:o.tips},{reference:v(()=>[Kt]),_:1},8,["content"])):z("",!0)],34)}}});const tn=O(en,[["__scopeId","data-v-d951e9d3"]]);const nn={class:"phoneconrol_wrapper"},on=a("div",{class:"cell-item"},"Current Activity",-1),sn=a("div",{class:"cell-item"},"Main Activity",-1),an=R({__name:"index",setup(e){const n=ye(),t=n.device,o=M(()=>!n.isVip);Z(()=>{});const h=M(()=>t==null?void 0:t.uploadUrl()),i=A(se),l=A(!1);function c(){l.value=!l.value}const p=A();async function m(){p.value.selectFile()}async function w(r,u){const y=r.data;let f=y,S=y.replace("/sdcard/","/data/local/tmp/");const T=`mv '${f}' '${S}'
pm install -r -d '${S}'
rm '${S}'`;await(t==null?void 0:t.execCmd(T))}async function D(){const r=await(t==null?void 0:t.screenShot()),u="screen_"+_e(Date.now(),"YYYY-MM-DD_HH_mm_ss");it(r,`${u}.jpg`,"image/jpeg")}async function F(){await(t==null?void 0:t.delFile("/sdcard/screen.mp4")),await(t==null?void 0:t.startRecoreScreen(180)),kt({title:C("ti-shi"),message:C("lu-ping-ren-wu-xi-tong-cheng-gong")})}async function J(){await(t==null?void 0:t.stopRecoreScreen());const r=t==null?void 0:t.downloadUrl("/sdcard/screen.mp4"),u="screen_"+_e(Date.now(),"YYYY-MM-DD_HH_mm_ss");me(r,`${u}.mp4`)}const _=A(),H=A(!1);async function Y(){const r=await(t==null?void 0:t.getTopActivity());_.value=r}async function P(){for(H.value=!1;!H.value;)await rt(2e3),await Y()}Z(()=>{P()}),be(()=>{H.value=!0});const W=Je();async function g(){W.push({name:"LayoutAnalysis"})}async function B(){var r,u;(r=_.value)!=null&&r.packageName?W.push({name:"AppInfo",query:{packageName:(u=_.value)==null?void 0:u.packageName}}):L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function X(){var r,u;if(await ge(C("que-ding-xie-zai-ci-ying-yong-ma")),(r=_.value)!=null&&r.packageName){const y=(u=_.value)==null?void 0:u.packageName;await(t==null?void 0:t.execCmd(`pm uninstall ${y}`))}else L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function Se(){var r,u;if((r=_.value)!=null&&r.packageName){const y=(u=_.value)==null?void 0:u.packageName;await(t==null?void 0:t.stopPackage(y)),L(C("cao-zuo-cheng-gong"))}else L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function xe(){var r,u;if((r=_.value)!=null&&r.packageName){const y=(u=_.value)==null?void 0:u.packageName;await(t==null?void 0:t.stopPackage(y)),await(t==null?void 0:t.startPackage(y)),L(C("cao-zuo-cheng-gong"))}else L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function Ee(){var r,u;if(await ge("确认清除数据吗？"),(r=_.value)!=null&&r.packageName){const y=(u=_.value)==null?void 0:u.packageName;await(t==null?void 0:t.clearPackage(y)),L(C("cao-zuo-cheng-gong"))}else L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function Ie(){var r,u;if((r=_.value)!=null&&r.packageName){const y=(u=_.value)==null?void 0:u.packageName,f=await(t==null?void 0:t.getPackageInfo(y)),S=f==null?void 0:f.applicationInfo.sourceDir,T=t==null?void 0:t.downloadUrl(S);me(T,`${y}.apk`)}else L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function Le(){var r,u;if((r=_.value)!=null&&r.packageName){const y=(u=_.value)==null?void 0:u.packageName,f=await(t==null?void 0:t.getPackageInfo(y)),S=f==null?void 0:f.applicationInfo.sourceDir;Ke.alert(S,C("an-zhuang-lu-jing"),{confirmButtonText:"OK",callback:T=>{De(S)}})}else L(C("wei-huo-qu-dao-ying-yong-xin-xi"))}async function Me(){t==null||t.pressKeyCode(x.volumeUp)}async function Ne(){t==null||t.pressKeyCode(x.volumeDown)}async function Te(){t==null||t.pressKeyCode(x.volumeMute)}async function Ae(){t==null||t.turnScreenOff()}return(r,u)=>{const y=lt,f=tn,S=Zt,T=et,ie=nt,He=ot,Ue=Ce,je=Vt;return b(),I("div",nn,[d(y,{ref_key:"uploadApk",ref:p,"is-show":!1,"upload-url":s(h),onOnUploadSuccess:w},null,8,["upload-url"]),d(S,{title:r.$t("chang-yong-gong-neng"),"tip-color":s(i).Lv},{body:v(()=>[d(f,{icon:"icon-anzhuang","bg-color":s(i).Hong,title:r.$t("an-zhuang-ying-yong"),disabled:s(o),onClick:u[0]||(u[0]=$=>m())},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-jietu","bg-color":s(i).Lv,title:r.$t("jie-tu-bao-cun"),disabled:s(o),onClick:u[1]||(u[1]=$=>D())},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-luping","bg-color":s(i).Lan,title:r.$t("kai-shi-lu-ping"),disabled:s(o),onClick:u[2]||(u[2]=$=>F())},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-tingzhi","bg-color":s(i).Hui,title:r.$t("jie-shu-lu-ping-bao-cun-dao-dian-nao"),disabled:s(o),onClick:u[3]||(u[3]=$=>J())},null,8,["bg-color","title","disabled"])]),_:1},8,["title","tip-color"]),d(S,{title:r.$t("ying-yong-xiang-guan"),"tip-color":s(i).Lan},{head:v(()=>[d(Ue,{placement:"top-start",width:500,trigger:"click"},{reference:v(()=>[d(T,{type:"primary",link:""},{default:v(()=>{var $;return[Q(k(r.$t("dang-qian-ying-yong"))+"："+k(($=s(_))==null?void 0:$.packageName),1)]}),_:1})]),default:v(()=>[d(He,{column:1,border:""},{default:v(()=>[d(ie,null,{label:v(()=>[on]),default:v(()=>{var $;return[Q(" "+k(($=s(_))==null?void 0:$.startPath),1)]}),_:1}),d(ie,null,{label:v(()=>[sn]),default:v(()=>{var $;return[Q(" "+k(($=s(_))==null?void 0:$.main),1)]}),_:1})]),_:1})]),_:1}),d(T,{icon:s(he),circle:""},null,8,["icon"])]),body:v(()=>[d(f,{icon:"icon-buju1","bg-color":s(i).Lan,title:r.$t("bu-ju-fen-xi"),disabled:s(o),onClick:g},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-line-uninstallxiezai","bg-color":s(i).Lan,title:r.$t("xie-zai-ying-yong"),disabled:s(o),onClick:X},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-tingzhi","bg-color":s(i).Hong,title:r.$t("ting-zhi-yun-hang"),disabled:s(o),onClick:Se},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-zhongbo","bg-color":s(i).QianLan,title:r.$t("zhong-qi-ying-yong"),disabled:s(o),onClick:xe},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-qingchu","bg-color":s(i).Lv,title:r.$t("qing-chu-shu-ju"),disabled:s(o),onClick:Ee},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-baocun","bg-color":s(i).Lan,title:r.$t("bao-cun-apk-dao-dian-nao"),disabled:s(o),onClick:Ie},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-chakan","bg-color":s(i).Cheng,title:r.$t("cha-kan-ying-yong-an-zhuang-lu-jing"),disabled:s(o),onClick:Le},null,8,["bg-color","title","disabled"]),d(f,{icon:"icon-shuxing","bg-color":s(i).Lan,title:r.$t("ying-yong-xiang-qing"),disabled:s(o),onClick:B},null,8,["bg-color","title","disabled"])]),_:1},8,["title","tip-color"]),d(S,{title:r.$t("an-jian-mo-ni"),"tip-color":s(i).Hong,layout:s(l)?s(j).Default:s(j).GRID},{head:v(()=>[Q(k(s(l)?r.$t("qie-huan-dao-pu-tong-mo-shi"):r.$t("qie-huan-dao-tv-mo-shi"))+" ",1),d(T,{icon:s(he),circle:"",onClick:u[4]||(u[4]=$=>c())},null,8,["icon"])]),body:v(()=>[s(l)?z("",!0):(b(),I(ve,{key:0},[d(f,{icon:"icon-zengjiayinliang","bg-color":s(i).Lan,title:r.$t("zeng-jia-yin-liang"),onClick:Me},null,8,["bg-color","title"]),d(f,{icon:"icon-shengyinjiangdiyinliang11","bg-color":s(i).Hong,title:r.$t("jiang-di-yin-liang"),onClick:Ne},null,8,["bg-color","title"]),d(f,{icon:"icon-jingyin","bg-color":s(i).QianLan,title:r.$t("jing-yin"),onClick:Te},null,8,["bg-color","title"]),d(f,{icon:"icon-a-13Gguanji","bg-color":s(i).QianLan,title:r.$t("xi-ping-kong-zhi"),disabled:s(o),onClick:Ae},null,8,["bg-color","title","disabled"])],64)),s(l)?(b(),U(je,{key:1})):z("",!0)]),_:1},8,["title","tip-color","layout"])])}}});const ln={name:"PhoneView",props:{url:{type:String,default:""},showHight:{type:Boolean,default:!0}},data(){return{isShowControl:!1,inputStr:"",mDevice:null,mDeviceControl:null,canvas:null,input:null,image:null,ctx:null,isLandscape:!1,screenWidth:0,screenHeight:0,isMouseDown:!1,lastPosition:{x:0,y:0}}},watch:{url:function(e,n){this.initServer()},inputStr:function(e,n){},showHight:function(e,n){this.startStreen()}},mounted(){this.init()},unmounted(){this.destory()},methods:{async init(){this.canvas=this.$refs.screen,this.input=this.$refs.input,this.ctx=this.canvas.getContext("2d"),this.image=new Image,this.input.addEventListener("compositionend",this.handleCompositionend.bind(this)),this.input.addEventListener("input",this.handleInput.bind(this)),this.input.addEventListener("keydown",this.handleKeyDown.bind(this)),this.initServer()},initServer(){if(this.mDevice!=null&&(this.destory(),this.mDevice=null),!this.url)return;let e=this,n=new fe.Device(this.url);this.mDevice=n,n.setWebSocketClient(new fe.BrowserWebSocket);let t=n.mScreenControl;this.mDeviceControl=t,t.addScreenChangeListener(o=>{var h=new FileReader;h.onload=function(i){i.target.readyState==FileReader.DONE&&e.renderImage(i.target.result)},h.readAsDataURL(o)}),t.addScreenOrentationChangeListener((o,h,i,l)=>{this.screenWidth=o,this.screenHeight=h,this.isLandscape=l,o>h?(this.canvas.width=1280,this.canvas.height=720):(this.canvas.width=720,this.canvas.height=1280)}),t.addClipTextChangeListener(o=>{console.log("粘贴板数据发生改变",o),De(o)}),this.startStreen()},startStreen(){this.mDeviceControl&&(this.showHight?this.mDeviceControl.startScreenStream(1,30,50):this.mDeviceControl.startScreenStream(.5,30,100),this.isShowControl=!0)},renderImage(e){let n=this;e&&(this.image.onload=function(){n.ctx.drawImage(n.image,0,0,n.ctx.canvas.width,n.ctx.canvas.height)},this.image.onerror=function(t){},this.image.src=e)},handleEvent(e){if(e.offsetY<0||e.offsetX<0)return;const n=this.canvas;let t=n.clientWidth,o=n.clientHeight,h=e.offsetX>t?t:e.offsetX,i=e.offsetY>o?o:e.offsetY,l=this.screenWidth,c=this.screenHeight,p=l*(h/t),m=c*(i/o);if(p=p<0?0:p,m=m<0?0:m,p===0||m===0)return;let w=parseInt(p),D=parseInt(m);return{x:w,y:D}},handleMouseDown(e){if(e.buttons===1){const n=this.handleEvent(e);if(n&&this.mDeviceControl){const{x:t,y:o}=n;this.mDeviceControl.sendTouchDown(t,o)}this.isMouseDown=!0}},handleMouseMove(e){if(e.buttons===1&&this.isMouseDown){const n=this.handleEvent(e);if(this.lastPosition=n,n&&this.mDeviceControl){const{x:t,y:o}=n;this.mDeviceControl.sendTouchMove(t,o)}}},handleMouseUp(e){const n=this.handleEvent(e);if(n&&this.mDeviceControl){const{x:t,y:o}=n;this.mDeviceControl.sendTouchUp(t,o)}this.isMouseDown=!1,this.input.focus()},handleMouseOut(e){this.isMouseDown=!1;const n=this.handleEvent(e)||this.lastPosition;if(n&&this.mDeviceControl){const{x:t,y:o}=n;this.mDeviceControl.sendTouchUp(t,o)}},handleCompositionend(e){if(this.mDeviceControl){let n=e.data;this.mDeviceControl.sendInputText(n)}e.target.value=""},handleInput(e){if(e.inputType==="insertText"){let n=e.data.trim();n&&this.mDeviceControl.sendInputChar(n),e.target.value=""}if(e.inputType==="insertFromPaste"){let n=e.target.value.trim();n&&this.mDeviceControl.sendInputText(n),e.target.value=""}},handleKeyDown(e){if(this.mDeviceControl)switch(e.keyCode){case 13:console.log("回车"),mScreenControl.sendEnterKey();break;case 32:console.log("空格"),this.mDeviceControl.sendSpaceKey();break;case 8:console.log("删除"),this.mDeviceControl.sendBackSpaceKey();break}},handleControlClick(e){if(this.mDeviceControl)switch(e){case 1:this.mDeviceControl.pressKeyCode(187);break;case 2:this.mDeviceControl.pressKeyCode(3);break;case 3:this.mDeviceControl.pressKeyCode(4);break;case 4:this.mDeviceControl.pressKeyCode(26);break}},destory(){try{this.mDevice!=null&&(this.isShowControl=!1,this.mDevice.destory())}catch{}}}},rn={class:"phoneview"},cn={ref:"input",class:"input_text",type:"text"},un={key:0,class:"phoneview_control"};function dn(e,n,t,o,h,i){return b(),I("div",rn,[a("canvas",{ref:"screen",class:E(["screen",{isLandscape:h.isLandscape}]),onMousedown:n[0]||(n[0]=(...l)=>i.handleMouseDown&&i.handleMouseDown(...l)),onMouseup:n[1]||(n[1]=(...l)=>i.handleMouseUp&&i.handleMouseUp(...l)),onMousemove:n[2]||(n[2]=(...l)=>i.handleMouseMove&&i.handleMouseMove(...l)),onMouseout:n[3]||(n[3]=(...l)=>i.handleMouseOut&&i.handleMouseOut(...l))},null,34),a("input",cn,null,512),h.isShowControl?(b(),I("ul",un,[a("li",{class:"phoneview_control_item iconfont icon-a-13Gguanji",onClick:n[4]||(n[4]=l=>i.handleControlClick(4))}),a("li",{class:"phoneview_control_item iconfont icon-liebiao",onClick:n[5]||(n[5]=l=>i.handleControlClick(1))}),a("li",{class:"phoneview_control_item iconfont icon-home1",onClick:n[6]||(n[6]=l=>i.handleControlClick(2))}),a("li",{class:"phoneview_control_item iconfont icon-chexiao",onClick:n[7]||(n[7]=l=>i.handleControlClick(3))})])):z("",!0)])}const pn=O(ln,[["render",dn],["__scopeId","data-v-1cafa39f"]]),hn={class:"app-container"},gn={class:"control_wrapper"},fn={class:"control_func"},mn=R({name:"Control",inheritAttrs:!1,__name:"index",setup(e){const n=A(location.host);return(t,o)=>{const h=pn,i=an,l=tt;return b(),I("div",hn,[d(l,null,{default:v(()=>[a("div",gn,[d(h,{url:s(n)},null,8,["url"]),a("div",fn,[d(i)])])]),_:1})])}}});const Nn=O(mn,[["__scopeId","data-v-79c58d9b"]]);export{Nn as default};
